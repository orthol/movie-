<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Portal - Premium Entertainment Access</title>

    <!-- 1. LOAD ADSENSE SYNCHRONOUSLY (no async) -->
    <script 
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4494471028788825"
        crossorigin="anonymous"></script>

    <!-- Social Bar -->
    <script type="text/javascript" src="//pawsdefenseneigh.com/ec/c0/88/ecc08815a6829b15e4fb449f2227fadd.js"></script>

    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:Segoe UI,Tahoma,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;}
        .container {width:100%;max-width:500px;text-align:center;}
        .card {background:rgba(255,255,255,.1);backdrop-filter:blur(15px);padding:30px;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.2);}
        h1 {font-size:2.2em;margin-bottom:10px;background:linear-gradient(45deg,#ff8a00,#e52e71);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        .subtitle {font-size:1.1em;margin-bottom:25px;opacity:.9;}
        .countdown {font-size:3.5em;margin:25px 0;color:#ffeb3b;font-weight:bold;text-shadow:0 0 10px rgba(255,235,59,.5);}
        .progress-container {width:100%;height:10px;background:rgba(255,255,255,.2);border-radius:5px;margin:20px 0;overflow:hidden;}
        .progress-bar {height:100%;background:linear-gradient(90deg,#FF416C,#FF4B2B);width:0%;border-radius:5px;transition:width .5s ease;}
        .ad-container {background:rgba(255,255,255,.05);padding:20px;margin:20px 0;border-radius:15px;border:1px solid rgba(255,255,255,.1);}
        .ad-unit {min-height:250px;background:rgba(255,255,255,.1);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:15px;position:relative;overflow:hidden;}
        .ad-notice {margin-bottom:15px;font-size:.9em;opacity:.9;}
        .continue-btn {background:linear-gradient(45deg,#FF416C,#FF4B2B);color:#fff;padding:18px;border-radius:50px;border:none;font-size:1.1em;font-weight:bold;cursor:pointer;width:100%;margin:20px 0;transition:all .3s;box-shadow:0 5px 15px rgba(255,65,108,.3);}
        .continue-btn:disabled {background:#666;cursor:not-allowed;transform:none;box-shadow:none;}
        .continue-btn:not(:disabled):hover {transform:translateY(-3px);box-shadow:0 8px 20px rgba(255,65,108,.4);}
        .smartlink-ad {background:linear-gradient(45deg,#9C27B0,#673AB7);color:#fff;padding:15px;border-radius:10px;margin:15px 0;cursor:pointer;display:none;box-shadow:0 5px 15px rgba(156,39,176,.3);transition:all .3s;}
        .smartlink-ad:hover {transform:scale(1.02);}
        .popunder-trigger {background:linear-gradient(45deg,#4CAF50,#45a049);color:#fff;border:none;padding:12px 20px;border-radius:25px;cursor:pointer;margin:10px 0;width:100%;box-shadow:0 3px 10px rgba(76,175,80,.3);transition:all .3s;}
        .popunder-trigger:hover {transform:scale(1.05);}
        .ad-verification {margin-top:20px;padding:15px;background:rgba(255,255,255,.05);border-radius:10px;display:none;}
        .footer-links {margin-top:20px;opacity:.7;font-size:.85em;}
        .footer-links a {color:#ffeb3b;text-decoration:none;}
        .adsense-container {position:relative;width:100%;min-height:250px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.2);border-radius:8px;overflow:hidden;}
        .ad-loading {position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;flex-direction:column;align-items:center;justify-content:center;color:rgba(255,255,255,.8);border-radius:8px;z-index:2;}
        .ad-loading-spinner {width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-top:4px solid #ffeb3b;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:10px;}
        @keyframes spin {to{transform:rotate(360deg);}}
        @media (max-width:768px){
            .card{padding:20px;}
            h1{font-size:1.8em;}
            .countdown{font-size:2.8em;}
        }
    </style>
</head>
<body>
<div class="container">
    <div class="card">
        <h1>Movie Portal</h1>
        <p class="subtitle">Your gateway to premium entertainment content</p>

        <div class="countdown" id="countdown">15</div>
        <p id="statusText">Please watch the advertisement for 15 seconds to continue...</p>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="ad-container">
            <div class="ad-unit">
                <div class="ad-notice"><strong>Please watch the advertisement below</strong></div>

                <!-- FIXED ADSENSE UNIT -->
                <div class="adsense-container">
                    <div class="ad-loading" id="adLoading">
                        <div class="ad-loading-spinner"></div>
                        <p>Loading AdSense...</p>
                    </div>

                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-4494471028788825"
                         data-ad-slot="8623997024"
                         data-ad-format="auto"
                         data-full-width-responsive="true"
                         data-ad-test="on"></ins> <!-- REMOVE data-ad-test="on" in production -->
                </div>
            </div>

            <div class="smartlink-ad" id="smartlinkAd">
                <h4>Exclusive Offer!</h4>
                <p>Click to open special offer</p>
                <small>Sponsored Content</small>
            </div>

            <div style="margin-top:15px;">
                <p style="font-size:.9em;margin-bottom:10px;opacity:.8;">Click below to trigger pop-under ads:</p>
                <button class="popunder-trigger" id="manualPopunder">Show Popunder Ad</button>
            </div>
        </div>

        <div class="ad-verification" id="adVerification">
            <h3>Advertisement Completed!</h3>
            <p>Thank you for watching. You can now continue.</p>
        </div>

        <button class="continue-btn" id="continueBtn" disabled>Access Premium Content</button>

        <div class="footer-links">
            <p>By continuing, you agree to our <a href="terms-of-service.html">Terms</a> and <a href="privacy-policy.html">Privacy Policy</a></p>
        </div>
    </div>
</div>

<!-- Popunder script -->
<script type="text/javascript" src="//pl27951177.effectivegatecpm.com/8d/5c/69/8d5c69d04dbd1bc1a95e35946b934ff5.js"></script>

<script>
/* ---------- COUNTDOWN ---------- */
let countdown = 15, countdownComplete = false;
const countdownEl = document.getElementById('countdown');
const progressBar = document.getElementById('progressBar');
const statusText = document.getElementById('statusText');
const continueBtn = document.getElementById('continueBtn');
const smartlinkAd = document.getElementById('smartlinkAd');
const adVerification = document.getElementById('adVerification');
const popunderBtn = document.getElementById('manualPopunder');
const adLoading = document.getElementById('adLoading');

function startCountdown(){
    const t = setInterval(()=>{
        countdown--;
        countdownEl.textContent = countdown;
        progressBar.style.width = ((15-countdown)/15*100)+'%';
        if(countdown<=0){
            clearInterval(t);
            countdownComplete = true;
            countdownEl.textContent = "Done!";
            statusText.textContent = "Thank you for watching the advertisement!";
            adVerification.style.display = 'block';
            smartlinkAd.style.display = 'block';
            continueBtn.disabled = false;
            autoOpenAdditionalAds();
        }
    },1000);
}

/* ---------- ADSENSE INITIALISATION ---------- */
function initAdSense(){
    // 2. Wait for the script to be fully loaded
    if(typeof adsbygoogle === 'undefined'){
        console.warn('AdSense not ready, retry...');
        setTimeout(initAdSense,500);
        return;
    }

    try{
        // 3. Push the ad
        (adsbygoogle = window.adsbygoogle || []).push({});
        console.log('AdSense push sent');

        let attempts = 0;
        const maxAttempts = 30; // 15 seconds total
        const check = setInterval(()=>{
            attempts++;
            const iframe = document.querySelector('.adsbygoogle iframe');
            if(iframe && iframe.offsetHeight > 20){
                clearInterval(check);
                adLoading.style.display = 'none';
                statusText.textContent = "Advertisement loaded! Please watch for 15 seconds...";
                console.log('AdSense iframe detected');
            }else if(attempts >= maxAttempts){
                clearInterval(check);
                showFallbackAd();
            }
        },500);

    }catch(e){
        console.error('AdSense error:',e);
        showFallbackAd();
    }
}

function showFallbackAd(){
    adLoading.innerHTML = `
        <div style="text-align:center;padding:20px;">
            <div style="font-size:3em;margin-bottom:15px;">Ad</div>
            <h3>Ad blocked or slow connection</h3>
            <p>Refresh the page to try again.</p>
            <button onclick="location.reload()" style="background:#ff5722;color:#fff;border:none;padding:8px 16px;border-radius:20px;cursor:pointer;margin-top:10px;">
                Refresh
            </button>
        </div>`;
}

/* ---------- EXTRA ADS ---------- */
function autoOpenAdditionalAds(){
    setTimeout(()=>window.open('https://pawsdefenseneigh.com/jkw1rm6r?key=0cbecd73a441d94361f1975264e27832','_blank'),1000);
}
smartlinkAd.onclick = ()=>window.open('https://pawsdefenseneigh.com/jkw1rm6r?key=0cbecd73a441d94361f1975264e27832','_blank');
popunderBtn.onclick = ()=>{
    const w = window.open('https://pawsdefenseneigh.com/jkw1rm6r?key=0cbecd73a441d94361f1975264e27832','_blank');
    if(w) setTimeout(()=>window.focus(),500);
};
continueBtn.onclick = ()=>{
    window.open('https://pawsdefenseneigh.com/jkw1rm6r?key=0cbecd73a441d94361f1975264e27832','_blank');
    setTimeout(()=>{location.href='https://t4tsa.cc/'},1000);
};

/* ---------- START ---------- */
window.addEventListener('load',()=>{
    startCountdown();
    initAdSense();          // will retry until ready
});

/* Fallback if something goes really wrong */
setTimeout(()=>{
    if(!countdownComplete){
        countdownComplete=true;
        countdownEl.textContent="Done!";
        statusText.textContent="Thank you for watching!";
        adVerification.style.display='block';
        smartlinkAd.style.display='block';
        continueBtn.disabled=false;
        autoOpenAdditionalAds();
    }
},16000);
</script>
</body>
</html>
